{"ast":null,"code":"import _regeneratorRuntime from\"/Users/umerraja/All Cloud Drives /Google Drive/Study/Study Data/Programming/Repositories/Projects/defever-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/umerraja/All Cloud Drives /Google Drive/Study/Study Data/Programming/Repositories/Projects/defever-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/umerraja/All Cloud Drives /Google Drive/Study/Study Data/Programming/Repositories/Projects/defever-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/umerraja/All Cloud Drives /Google Drive/Study/Study Data/Programming/Repositories/Projects/defever-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/umerraja/All Cloud Drives /Google Drive/Study/Study Data/Programming/Repositories/Projects/defever-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/umerraja/All Cloud Drives /Google Drive/Study/Study Data/Programming/Repositories/Projects/defever-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import PostsApi from\"./../../api/PostsApi\";import PostForm from\"./PostForm\";import PostCard from\"./PostCard\";import UserApi from\"../../api/UserApi\";var PostsPage=/*#__PURE__*/function(_React$Component){_inherits(PostsPage,_React$Component);var _super=_createSuper(PostsPage);function PostsPage(props){var _this;_classCallCheck(this,PostsPage);_this=_super.call(this,props);_this.state={user:{},posts:[]};return _this;}_createClass(PostsPage,[{key:\"createPost\",value:function(){var _createPost=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(postData){var user,response,post,newPosts;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(postData!==undefined)){_context.next=14;break;}_context.prev=1;user=this.state.user;_context.next=5;return PostsApi.createPost({body:postData.body,date:new Date().toLocaleString(),likes:[],user:user});case 5:response=_context.sent;post=response.data;newPosts=this.state.posts.concat(post);this.setState({posts:newPosts});_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);console.error(_context.t0);case 14:case\"end\":return _context.stop();}}},_callee,this,[[1,11]]);}));function createPost(_x){return _createPost.apply(this,arguments);}return createPost;}()},{key:\"updatePost\",value:function(){var _updatePost=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(newPostData){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return PostsApi.updatePost({id:newPostData.id,body:newPostData.body,date:newPostData.date,likes:newPostData.likes,user:newPostData.user});case 3:_context2.next=8;break;case 5:_context2.prev=5;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0);case 8:case\"end\":return _context2.stop();}}},_callee2,null,[[0,5]]);}));function updatePost(_x2){return _updatePost.apply(this,arguments);}return updatePost;}()},{key:\"deletePost\",value:function(){var _deletePost=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(post){var newPosts;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return PostsApi.deletePost(post.id);case 3:newPosts=this.state.posts.filter(function(p){return p.id!==post.id;});this.setState({posts:newPosts});_context3.next=10;break;case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](0);console.error(_context3.t0);case 10:case\"end\":return _context3.stop();}}},_callee3,this,[[0,7]]);}));function deletePost(_x3){return _deletePost.apply(this,arguments);}return deletePost;}()},{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;PostsApi.getAllPosts().then(function(_ref){var data=_ref.data;return _this2.setState({posts:data});}).catch(function(err){return console.error(err);});UserApi.current().then(function(_ref2){var data=_ref2.data;return _this2.setState({user:data});}).catch(function(err){return console.error(err);});}},{key:\"render\",value:function render(){var _this3=this;var posts=this.state.posts.sort(function(post1,post2){return post1.likes<=post2.likes?1:-1;});return/*#__PURE__*/React.createElement(\"div\",{className:\" shadow-lg   rounded\"},/*#__PURE__*/React.createElement(PostForm,{className:\"card m-5\",onSubmit:function onSubmit(postData){return _this3.createPost(postData);}}),posts.map(function(post){return/*#__PURE__*/React.createElement(PostCard,{className:\"card m-5\",key:post.id,currentUser:_this3.state.user,post:post,onLikeClick:function onLikeClick(newPostData){return _this3.updatePost(newPostData);},onDeleteClick:function onDeleteClick(){return _this3.deletePost(post);}});}));}}]);return PostsPage;}(React.Component);export default PostsPage;","map":{"version":3,"sources":["/Users/umerraja/All Cloud Drives /Google Drive/Study/Study Data/Programming/Repositories/Projects/defever-client/src/components/posts/PostsPage.js"],"names":["React","PostsApi","PostForm","PostCard","UserApi","PostsPage","props","state","user","posts","postData","undefined","createPost","body","date","Date","toLocaleString","likes","response","post","data","newPosts","concat","setState","console","error","newPostData","updatePost","id","deletePost","filter","p","getAllPosts","then","catch","err","current","sort","post1","post2","map","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport PostsApi from \"./../../api/PostsApi\";\nimport PostForm from \"./PostForm\";\nimport PostCard from \"./PostCard\";\nimport UserApi from \"../../api/UserApi\";\n\nclass PostsPage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      user: {},\n      posts: [],\n    };\n  }\n\n\n\n  async createPost(postData) {\n    if(postData !== undefined) {\n      try {\n        const user = this.state.user;\n        const response = await PostsApi.createPost({body: postData.body,\n        date: new Date().toLocaleString(), likes: [], user});\n        const post = response.data;\n        const newPosts = this.state.posts.concat(post);\n  \n        this.setState({\n          posts: newPosts,\n        });\n      } catch (e) {\n        console.error(e);\n      }\n    }\n  }\n\n  async updatePost(newPostData) {\n    try {\n      await PostsApi.updatePost({id: newPostData.id, body: newPostData.body,\n      date: newPostData.date, likes: newPostData.likes, user: newPostData.user});\n    } catch (e) {\n      console.error(e);\n    }\n  }\n\n  async deletePost(post) {\n    try {\n      await PostsApi.deletePost(post.id);\n      const newPosts = this.state.posts.filter((p) => p.id !== post.id);\n      this.setState({\n        posts: newPosts,\n      });\n    } catch (e) {\n      console.error(e);\n    }\n  }\n\n  componentDidMount() {\n    PostsApi.getAllPosts()\n      .then(({ data }) => this.setState({ posts: data }))\n      .catch((err) => console.error(err));\n    UserApi.current()\n      .then(( {data }) => this.setState({ user: data }))\n      .catch((err) => console.error(err));\n  }\n\n  render() {\n    const posts = this.state.posts.sort((post1, post2) =>\n                  (post1.likes <= post2.likes) ? 1 : -1);\n\n\n    return (\n      <div className=\" shadow-lg   rounded\">\n        <PostForm className =\"card m-5\" onSubmit={(postData) => this.createPost(postData)} />\n\n        {posts.map((post) => (\n          <PostCard\n          className =\"card m-5\"\n            key={post.id}\n            currentUser={this.state.user}\n            post={post}\n            onLikeClick={(newPostData) => this.updatePost(newPostData)}\n            onDeleteClick={() => this.deletePost(post)}\n          />\n        ))}\n      </div>\n    );\n  }\n}\n\nexport default PostsPage;\n"]},"metadata":{},"sourceType":"module"}