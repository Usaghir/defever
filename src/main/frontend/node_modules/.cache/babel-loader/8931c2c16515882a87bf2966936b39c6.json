{"ast":null,"code":"import _regeneratorRuntime from\"/Users/umerraja/All Cloud Drives /Google Drive/Study/Study Data/Programming/Repositories/Projects/defever-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/umerraja/All Cloud Drives /Google Drive/Study/Study Data/Programming/Repositories/Projects/defever-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/umerraja/All Cloud Drives /Google Drive/Study/Study Data/Programming/Repositories/Projects/defever-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/umerraja/All Cloud Drives /Google Drive/Study/Study Data/Programming/Repositories/Projects/defever-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import AuthApi from\"../api/AuthApi\";var tokenKey=\"_token\";// Disclaimer: This simple auth implementation is for development purposes only.\nvar Auth=/*#__PURE__*/function(){function Auth(){_classCallCheck(this,Auth);this.setLoggedIn=function(){};}_createClass(Auth,[{key:\"isLoggedIn\",value:function isLoggedIn(){return this._getToken()!=null;}},{key:\"login\",value:function(){var _login=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(loginData){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this._loginOrRegister(AuthApi.authenticate,loginData);case 2:return _context.abrupt(\"return\",_context.sent);case 3:case\"end\":return _context.stop();}}},_callee,this);}));function login(_x){return _login.apply(this,arguments);}return login;}()},{key:\"register\",value:function(){var _register=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(registrationData){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return this._loginOrRegister(AuthApi.register,registrationData);case 2:return _context2.abrupt(\"return\",_context2.sent);case 3:case\"end\":return _context2.stop();}}},_callee2,this);}));function register(_x2){return _register.apply(this,arguments);}return register;}()},{key:\"logout\",value:function logout(){this.setLoggedIn(false);this._clearToken();}},{key:\"bindLoggedInStateSetter\",value:function bindLoggedInStateSetter(loggedInStateSetter){this.setLoggedIn=loggedInStateSetter;}},{key:\"getAuthorizationHeader\",value:function getAuthorizationHeader(){return\"Bearer \"+this._getToken();}},{key:\"_loginOrRegister\",value:function(){var _loginOrRegister2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(action,data){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return action(data);case 3:response=_context3.sent;this._setToken(response.data.token);this.setLoggedIn(true);return _context3.abrupt(\"return\",true);case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](0);console.error(_context3.t0);this.setLoggedIn(false);return _context3.abrupt(\"return\",false);case 14:case\"end\":return _context3.stop();}}},_callee3,this,[[0,9]]);}));function _loginOrRegister(_x3,_x4){return _loginOrRegister2.apply(this,arguments);}return _loginOrRegister;}()},{key:\"_getToken\",value:function _getToken(){return window.sessionStorage.getItem(tokenKey);}},{key:\"_setToken\",value:function _setToken(token){window.sessionStorage.setItem(tokenKey,token);}},{key:\"_clearToken\",value:function _clearToken(){window.sessionStorage.removeItem(tokenKey);}}]);return Auth;}();export default new Auth();","map":{"version":3,"sources":["/Users/umerraja/All Cloud Drives /Google Drive/Study/Study Data/Programming/Repositories/Projects/defever-client/src/services/Auth.js"],"names":["AuthApi","tokenKey","Auth","setLoggedIn","_getToken","loginData","_loginOrRegister","authenticate","registrationData","register","_clearToken","loggedInStateSetter","action","data","response","_setToken","token","console","error","window","sessionStorage","getItem","setItem","removeItem"],"mappings":"u5BAAA,MAAOA,CAAAA,OAAP,KAAoB,gBAApB,CAEA,GAAMC,CAAAA,QAAQ,CAAG,QAAjB,CAEA;GAEMC,CAAAA,I,yEACFC,W,CAAc,UAAM,CAAE,C,kEAET,CACT,MAAO,MAAKC,SAAL,IAAoB,IAA3B,CACH,C,oHAEWC,S,wIACK,MAAKC,gBAAL,CAAsBN,OAAO,CAACO,YAA9B,CAA4CF,SAA5C,C,wTAGFG,gB,6IACE,MAAKF,gBAAL,CAAsBN,OAAO,CAACS,QAA9B,CAAwCD,gBAAxC,C,kPAGR,CACL,KAAKL,WAAL,CAAiB,KAAjB,EACA,KAAKO,WAAL,GACH,C,wEAEuBC,mB,CAAqB,CACzC,KAAKR,WAAL,CAAmBQ,mBAAnB,CACH,C,uEAEwB,CACrB,MAAO,UAAU,KAAKP,SAAL,EAAjB,CACH,C,2IAEsBQ,M,CAAQC,I,2KAEAD,CAAAA,MAAM,CAACC,IAAD,C,QAAvBC,Q,gBACN,KAAKC,SAAL,CAAeD,QAAQ,CAACD,IAAT,CAAcG,KAA7B,EACA,KAAKb,WAAL,CAAiB,IAAjB,E,iCACO,I,6DAEPc,OAAO,CAACC,KAAR,eAEA,KAAKf,WAAL,CAAiB,KAAjB,E,iCACO,K,sOAIH,CACR,MAAOgB,CAAAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,CAA8BpB,QAA9B,CAAP,CACH,C,4CAESe,K,CAAO,CACbG,MAAM,CAACC,cAAP,CAAsBE,OAAtB,CAA8BrB,QAA9B,CAAwCe,KAAxC,EACH,C,iDAEa,CACVG,MAAM,CAACC,cAAP,CAAsBG,UAAtB,CAAiCtB,QAAjC,EACH,C,oBAIL,cAAe,IAAIC,CAAAA,IAAJ,EAAf","sourcesContent":["import AuthApi from \"../api/AuthApi\";\n\nconst tokenKey = \"_token\";\n\n// Disclaimer: This simple auth implementation is for development purposes only.\n\nclass Auth {\n    setLoggedIn = () => {};\n\n    isLoggedIn() {\n        return this._getToken() != null;\n    }\n\n    async login(loginData) {\n        return await this._loginOrRegister(AuthApi.authenticate, loginData);\n    }\n\n    async register(registrationData) {\n        return await this._loginOrRegister(AuthApi.register, registrationData);\n    }\n\n    logout() {\n        this.setLoggedIn(false);\n        this._clearToken();\n    }\n\n    bindLoggedInStateSetter(loggedInStateSetter) {\n        this.setLoggedIn = loggedInStateSetter;\n    }\n\n    getAuthorizationHeader() {\n        return \"Bearer \"+this._getToken();\n    }\n\n    async _loginOrRegister(action, data) {\n        try {\n            const response = await action(data);\n            this._setToken(response.data.token);\n            this.setLoggedIn(true);\n            return true;\n        } catch (e) {\n            console.error(e);\n            \n            this.setLoggedIn(false);\n            return false;\n        }\n    }\n\n    _getToken() {\n        return window.sessionStorage.getItem(tokenKey);\n    }\n\n    _setToken(token) {\n        window.sessionStorage.setItem(tokenKey, token);\n    }\n\n    _clearToken() {\n        window.sessionStorage.removeItem(tokenKey);\n    }\n}\n\n\nexport default new Auth();"]},"metadata":{},"sourceType":"module"}